(function(e,b){if(!e.OData)e.OData={};var c=e.OData,ob=function(a,c,d){if(!a.method)a.method="GET";if(!a.headers)a.headers={};if(a.headers.Accept===b)a.headers.Accept=c.accept;a.data&&a.body===b&&c.write(a,d)},tc=function(a,g,c,f,d,e){d.request(a,function(d){try{d.data===b&&f.read(d,e);g(d.data,d)}catch(h){if(h.request===b)h.request=a;if(h.response===b)h.response=d;c(h)}},c)},d={feed:"feed",entry:"entry",svcDoc:"service document",complexType:"complex",primitiveType:"primitive",batch:"batch",unknown:"unknown",none:"none"},i={complex:"complex",deferred:"deferred",inline:"inline",primitive:"primitive",none:"none"},s=function(a){switch(typeof a){case"object":return!a?d.none:l(a)||l(a.results)?d.feed:a.__metadata&&a.__metadata.uri!==b?d.entry:l(a.EntitySets)?d.svcDoc:l(a.__batchRequests)?d.batch:Oc(a)?d.primitiveType:d.complexType;case"string":case"number":case"boolean":return d.primitiveType;default:return d.unknown}},rc=function(a){switch(s(a)){case d.complexType:return a.__deferred&&a.__deferred.uri?i.deferred:i.complex;case d.feed:case d.entry:return i.inline;case d.primitiveType:return i.primitive;default:return i.none}},Oc=function(a){return Object.prototype.toString.call(a)==="[object Date]"},l=function(a){return Object.prototype.toString.call(a)==="[object Array]"},Kc=function(b,d){var a,c;for(a=0,c=b.length;a<c;a++)if(b[a]===d)return true;return false},z=function(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")},Q=0,Cc=function(a){return a.method&&a.method!=="GET"?false:true},uc=function(a){return a.indexOf("http://")===0||a.indexOf("https://")===0||a.indexOf("file://")===0},Fc=function(a){if(!uc(a))return true;var b=e.location.protocol+"//"+e.location.host+"/";return a.indexOf(b)===0?true:false},sc=function(c,a){try{delete e[a]}catch(d){e[a]=b;if(c===Q-1)Q-=1}},ac=function(f,e){var b=f.getAllResponseHeaders().split(/\r?\n/),a,d;for(a=0,d=b.length;a<d;a++)if(b[a]){var c=b[a].split(": ");e[c[0]]=c[1]}};c.defaultHttpClient={callbackParameterName:"$callback",formatQueryString:"$format=json",enableJsonpCallback:false,request:function(d,j,i){var l={},a=null,p=false;l.abort=function(){if(!a)return;p=true;a.abort();a=null;i({message:"Request aborted"})};var f,b=d.requestUri;if(!this.enableJsonpCallback||Fc(b)){a=new XMLHttpRequest;a.onreadystatechange=function(){if(a===null||a.readyState!==4)return;var e=a.statusText,c=a.status;if(c===1223){c=204;e="No Content"}var g=[];ac(a,g);var f={requestUri:b,statusCode:c,statusText:e,headers:g,body:a.responseText};a=null;if(c>=200&&c<=299)j(f);else i({message:"HTTP request failed",request:d,response:f})};a.open(d.method||"GET",b,true);if(d.headers)for(f in d.headers)a.setRequestHeader(f,d.headers[f]);if(d.timeoutMS){a.timeout=d.timeoutMS;a.ontimeout=function(){if(a){a=null;i({message:"Request timed out"})}}}a.send(d.body)}else{if(!Cc(d))throw{message:"Request is not local and cannot be done through JSONP."};var n=Q++,o=n.toString();f="handleJSONP_"+o;e[f]=function(a){sc(f,n);a=a.d;a=c.jsonHandler._updateDataFromVersion(a);a=c.jsonHandler._normalizeData(a,b);j({data:a,statusCode:200})};var h=document.createElement("SCRIPT");h.setAttribute("type","text/javascript");var g=this.callbackParameterName+"="+f;if(this.formatQueryString)g+="&"+this.formatQueryString;var k=b.indexOf("?");if(k===-1)b=b+"?"+g;else if(k===b.length-1)b=b+g;else b=b+"&"+g;h.setAttribute("src",b);var m=document.getElementsByTagName("HEAD")[0];m.appendChild(h);m=h=null}return l}};var t=function(f){if(!f)return null;var b=f.split(";"),d={},a,e;for(a=1,e=b.length;a<e;a++){var c=b[a].split("=");d[z(c[0])]=c[1]}return{mediaType:z(b[0]),properties:d}},Zb=function(a){if(!a)return b;var d=a.mediaType,c;for(c in a.properties)d+=";"+c+"="+a.properties[c];return d},ab=function(b,a,c,d){return{contentType:b,dataServiceVersion:a,metadata:c,handler:d}},gb=function(b,c,d){if(!b)return;var a=b.headers;if(!a[c])a[c]=d},Qb=function(a,b){if(!a.dataServiceVersion)a.dataServiceVersion=b},V=function(c,d){var a=c.headers;return a&&a[d]||b},mb=function(a){return t(V(a,"Content-Type"))},db=function(a){return V(a,"DataServiceVersion")},nb=function(a,b){return a.accept.indexOf(b.mediaType)>=0},Dc=function(c,h,a,f){if(!a||!a.headers)return false;var g=mb(a),i=db(a)||c.maxDataServiceVersion,d=a.body;if(d===b||d===null)return false;if(nb(c,g)){var e=ab(g,i,f?f.metadata:null,c);e.response=a;a.data=h(c,d,e);return a.data&&true}return false},wc=function(c,f,a,e){if(!a||!a.headers)return false;var d=mb(a),g=db(a);if(!d||nb(c,d)){var b=ab(d,g,e?e.metadata:null,c);b.request=a;a.body=f(c,a.data,b);if(a.body){gb(a,"DataServiceVersion",b.dataServiceVersion||"1.0");gb(a,"Content-Type",Zb(b.contentType));return true}}return false},B=function(c,b,d,a){return{accept:d,maxDataServiceVersion:a,read:function(a,b){return Dc(this,c,a,b)},write:function(c,a){return wc(this,b,c,a)}}},Ac="application/xml",Lc=/^([^:/?#]+:)?(\/\/[^/?#]*)?([^?#:]+)?(\?[^#]*)?(#.*)?/,Db="http://",F=Db+"www.w3.org/",v=Db+"schemas.microsoft.com/ado/",E=v+"2007/08/dataservices",C=F+"2000/xmlns/",R=F+"XML/1998/namespace",Cb=v+"2007/06/edmx",Pc=v+"2008/09/edm",Mc=v+"2006/04/edm",Nc=v+"2007/05/edm",f=F+"2005/Atom",u=F+"2007/app",n=E,g=E+"/metadata",K=E+"/related/",wb=E+"/scheme",vb=["scheme","authority","path","query","fragment"],zb=function(e){var b={isAbsolute:false};if(e){var c=Lc.exec(e);if(c){var a,d;for(a=0,d=vb.length;a<d;a++)if(c[a+1])b[vb[a]]=c[a+1]}if(b.scheme)b.isAbsolute=true}return b},k=function(d,e){if(!e)return d;var b=zb(d);if(b.isAbsolute)return d;var c=zb(e),a={};if(b.authority){a.authority=b.authority;a.path=b.path;a.query=b.query}else{if(!b.path){a.path=c.path;a.query=b.query||c.query}else{if(b.path.charAt(0)==="/")a.path=b.path;else a.path=Wb(b,c);a.query=b.query}a.authority=c.authority}a.scheme=c.scheme;a.fragment=b.fragment;return"".concat(a.scheme||"",a.authority||"",a.path||"",a.query||"",a.fragment||"")},Wb=function(c,b){var a="/";if(b.path){var d=b.path.lastIndexOf("/");a=b.path.substring(0,d);if(a.charAt(a.length-1)!=="/")a=a+"/"}return a+c.path},Gb=function(a){var b=/(^\s)|(\s$)/;return b.test(a)},a={addNamespaceAttribute:function(c,d,e){var b=c.ownerDocument,a;if(b.createAttributeNS)a=b.createAttributeNS(C,d);else a=b.createNode(2,d,C);a.nodeValue=e;c.setAttributeNode(a)},appendAsXml:function(c,d){var g="<container>"+d+"</container>",f=a.parse(g,null),e=c.ownerDocument.importNode(f.domNode,true),b=e.firstChild;while(b){c.appendChild(b);b=b.nextSibling}},appendPreserving:function(a,b){Gb(b)&&a.setAttribute("xml:space","preserve");var c=a.ownerDocument.createTextNode(b);a.appendChild(c)},attributes:function(f,e){var b,c=f.domNode,a,d;for(a=0,d=c.attributes.length;a<d;a++){b=c.attributes.item(a);e(this._wrapNode(b))}},attribute:function(b,a,c){return this._attribute(b.domNode,a,c)},attributeNode:function(d,b,c){var a=d.attributes;return a.getNamedItemNS?a.getNamedItemNS(c,b):a.getQualifiedItem(b,c)},childElements:function(c,d){var a=c.domNode.firstChild,b;while(a!==null){if(a.nodeType===1){b=k(this._baseURI(a),c.baseURI);d(this._wrapNode(a,b))}a=a.nextSibling}},firstDomElementChild:function(b){var a=b.firstChild;while(a){if(a.nodeType===1)break;a=a.nextSibling}return a},firstElement:function(c){var a=c.domNode.firstChild,b;while(a!==null){if(a.nodeType===1){b=k(this._baseURI(a),c.baseURI);return this._wrapNode(a,b)}a=a.nextSibling}return null},getSingleElementByTagNameNS:function(c,e,f){var d;if(c.getElementsByTagNameNS){d=c.getElementsByTagNameNS(e,f);if(d.length!==0)return d[0]}else{var b=c.firstChild;while(b){if(b.nodeType===1&&a.localName(b)===f&&b.namespaceURI===e)return b;b=b.nextSibling}}return null},innerText:function(e){var c=e.text;if(c!==b)return c;c="";var a=e.firstChild;if(a)do{if(a.nodeType===3||a.nodeType===4)c+=a.nodeValue;var d=a.firstChild;if(!d)while(a!==e){d=a.nextSibling;if(d){a=d;break}else a=a.parentNode}else a=d}while(a!==e);return c},localName:function(a){return a.localName?a.localName:a.baseName},newDocument:function(c,b){var a;if(e.ActiveXObject){a=new ActiveXObject("Msxml2.DOMDocument.6.0");a.async=false;a.documentElement=a.createNode(1,c,b)}else if(e.document.implementation&&e.document.implementation.createDocument)a=e.document.implementation.createDocument(b,c,null);var d=a.createProcessingInstruction("xml","version='1.0' encoding='utf-8'");a.insertBefore(d,a.documentElement);return this._wrapNode(a.documentElement)},newDomAttribute:function(d,c,g,f){var e=d.ownerDocument,a;c=f?f+":"+c:c;if(e.createAttributeNS){a=e.createAttributeNS(g,c);d.setAttributeNodeNS(a)}else{a=e.createNode(2,c,g||b);d.setAttributeNode(a)}return a},newDomElement:function(f,a,g,e){var d=f.ownerDocument,c;a=e?e+":"+a:a;if(d.createElementNS)c=d.createElementNS(g,a);else c=d.createNode(1,a,g||b);f.appendChild(c);return c},newElement:function(d,g,e,f){var c=d.domNode.ownerDocument,a;if(c.createElementNS)a=c.createElementNS(e,g);else a=c.createNode(1,g,e||b);f&&this.appendPreserving(a,f);d.domNode.appendChild(a);return this._wrapNode(a)},newAttribute:function(c,g,e,f){var d=c.domNode.ownerDocument,a;if(d.createAttributeNS){a=d.createAttributeNS(e,g);a.value=f;c.domNode.setAttributeNodeNS(a)}else{a=d.createNode(2,g,e||b);a.value=f;c.domNode.setAttributeNode(a)}return this._wrapNode(a)},qualifyXmlTagName:function(b,a){return a?a+":"+b:b},parse:function(d,c){var a=this._parse(d),b=k(this._baseURI(a),c);return this._wrapNode(a,b)},serialize:function(a){var b=a.domNode.ownerDocument;return this.serializeNode(b)},serializeChildren:function(f){var d=f.childNodes,a,h=d.length;if(h===0)return"";var c=f.ownerDocument.createDocumentFragment();for(a=0;a<h;a++)c.appendChild(d[a].cloneNode(true));var g=c.xml;if(g!==b)return g;else{var i=new e.XMLSerializer;return i.serializeToString(c)}},serializeNode:function(a){var c=a.xml;if(c!==b)return c;if(e.XMLSerializer){var d=new e.XMLSerializer;return d.serializeToString(a)}throw{message:"XML serialization unsupported"};},_attribute:function(a,b,c){if(a.getAttributeNS)return a.getAttributeNS(c||null,b);var d=a.attributes.getQualifiedItem(b,c);return d?d.value:null},_baseURI:function(a){return this._attribute(a,"base",R)},_parse:function(b){var a;if(e.ActiveXObject){a=new ActiveXObject("Msxml2.DOMDocument.6.0");a.async=false;a.loadXML(b);if(a.parseError.errorCode!==0)throw{message:a.parseError.reason,errorXmlText:b,srcText:a.parseError.srcText};}else{var c=new e.DOMParser;a=c.parseFromString(b,"text/xml")}return a.documentElement},_wrapNode:function(a,b){return{baseURI:b,domNode:a,localName:this.localName(a),nsURI:a.namespaceURI||null}}};c.xml=a;c.xmlNS=R;c.xmlnsNS=C;c.normalizeURI=k;var ib=["application/atom+xml","application/atomsvc+xml","application/xml"],qb=ib[0],Ic=a.qualifyXmlTagName("inline","m"),vc=a.qualifyXmlTagName("properties","m"),Tb=a.qualifyXmlTagName("type","m"),Sb=a.qualifyXmlTagName("null","m"),Rb=[f,u,R,C],Lb={SyndicationAuthorEmail:"author/email",SyndicationAuthorName:"author/name",SyndicationAuthorUri:"author/uri",SyndicationContributorEmail:"contributor/email",SyndicationContributorName:"contributor/name",SyndicationContributorUri:"contributor/uri",SyndicationPublished:"published",SyndicationRights:"rights",SyndicationSummary:"summary",SyndicationTitle:"title",SyndicationUpdated:"updated"},J=function(c,b,i){if(!b)return null;var a,d;if(b.dataServices){var f,e;f=b.dataServices.schema;for(a=0,d=f.length;a<d;a++){e=J(c,f[a],i);if(e)return e}}else{var h=b["namespace"];if(c.indexOf(h)!==0)return null;if(c[h.length]!==".")return null;var j=c.substr(h.length+1),g=b[i];for(a=0,d=g.length;a<d;a++)if(g[a].name===j)return g[a]}return null},fb=function(d,a,e){if(!d||!a)return null;if(l(a)){var b,f,c;for(b=0,f=a.length;b<f;b++){c=J(d,a[b],e);if(c)return c}}else return J(d,a,e)},dc=function(b,a){return fb(b,a,"complexType")},x=function(b,a){return fb(b,a,"entityType")},y=function(a){return!Kc(Rb,a)},m=function(a){return a},Jc=function(a){return a==="true"},bb={"Edm.Boolean":Jc,"Edm.Binary":m,"Edm.DateTime":m,"Edm.Decimal":m,"Edm.Guid":m,"Edm.String":m,"Edm.Time":m,"Edm.DateTimeOffSet":m,"Edm.Byte":parseInt,"Edm.Double":parseFloat,"Edm.Single":parseFloat,"Edm.Int16":parseInt,"Edm.Int32":parseInt,"Edm.Int64":m,"Edm.SByte":parseInt},h=function(a){return a.toString()},Nb={"Edm.Boolean":h,"Edm.Binary":h,"Edm.DateTime":h,"Edm.Decimal":h,"Edm.Guid":h,"Edm.String":h,"Edm.Time":h,"Edm.DateTimeOffSet":h,"Edm.Byte":h,"Edm.Double":h,"Edm.Single":h,"Edm.Int16":h,"Edm.Int32":h,"Edm.Int64":h,"Edm.SByte":h},L=function(a){return a&&bb[a]!==b},U=function(a,b){if(a!==null&&b){var c=bb[b];if(c)a=c(a)}return a},W=function(a,b){if(a!==null&&b){var c=Nb[b];if(c)a=c(a)}return a},hb=function(a,b){if(a.nsURI===f)switch(a.localName){case"feed":return xc(a,b);case"entry":return rb(a,b)}if(a.nsURI===u&&a.localName==="service")return Mb(a);throw{message:"Invalid AtomPub document: root element can only be feed, entry, or service",element:a};},xc=function(c,d){var b={results:[],__metadata:{}};b.__metadata.feed_extensions=o(c);a.childElements(c,function(c){switch(c.nsURI){case f:switch(c.localName){case"id":b.__metadata.uri=k(a.innerText(c.domNode),c.baseURI);b.__metadata.uri_extensions=o(c);break;case"title":b.__metadata.title=a.innerText(c.domNode);b.__metadata.title_extensions=o(c);break;case"entry":var h=rb(c,d);b.results.push(h);break;case"link":ic(c,b)}return;case g:if(c.localName==="count"){b.__count=parseInt(a.innerText(c.domNode));return}}var e=q(c);b.__metadata.feed_extensions.push(e)});return b},ic=function(c,b){var a=ub(c);switch(a.rel){case"next":b.__next=a.href;b.__metadata.next_extensions=a.extensions;break;case"self":b.__metadata.self=a.href;b.__metadata.self_extensions=a.extensions}},ub=function(c){var b={extensions:[]},d;a.attributes(c,function(a){if(!a.nsURI)switch(a.localName){case"href":b.href=k(a.domNode.nodeValue,c.baseURI);return;case"type":case"rel":b[a.localName]=a.domNode.nodeValue;return}if(y(a.nsURI)){d=p(a);b.extensions.push(d)}});if(!b.href)throw{error:"href attribute missing on link element",element:c};return b},q=function(b){var c={name:b.localName,namespaceURI:b.nsURI,attributes:o(b),children:[]};a.childElements(b,function(b){var a=q(b);c.children.push(a)});if(c.children.length===0){var d=a.innerText(b.domNode);if(d)c.value=d}return c},o=function(c){var b=[];a.attributes(c,function(a){if(y(a.nsURI)){var c=p(a);b.push(c)}});return b},p=function(a){return{name:a.localName,namespaceURI:a.nsURI,value:a.domNode.nodeValue}},eb=function(d,a){if(d.indexOf("/")===-1)return a[d];else{var e=d.split("/"),c,f;for(c=0,f=e.length;c<f;c++){if(a===null)return b;a=a[e[c]];if(a===b)return a}return a}},Yb=function(g,a,k,h){var d;if(g.indexOf("/")===-1){a[g]=k;d=g}else{var f=g.split("/"),c,l;for(c=0,l=f.length-1;c<l;c++){var e=a[f[c]];if(e===b){e={};a[f[c]]=e}else if(e===null)return;a=e}d=f[c];a[d]=k}if(h){var j=a.__metadata=a.__metadata||{},i=j.properties=j.properties||{},m=i[d]=i[d]||{};m.type=h}},Z=function(a){return Lb[a]||a},kc=function(g,i,c,h){var e=i.split("/"),d,f;for(d=0,f=e.length;d<f;d++)if(e[d][0]==="@")return a._attribute(c,e[d].substring(1),g);else{c=a.getSingleElementByTagNameNS(c,g,e[d]);if(!c)return b}return h?a.serializeChildren(c):a.innerText(c)},lc=function(f,h,l,k,j,g){var b=k,e=l.split("/"),c,i;for(c=0,i=e.length;c<i;c++){var d;if(e[c][0]==="@"){d=a.attributeNode(b,e[c].substring(1),f);if(!d)d=a.newDomAttribute(b,e[c].substring(1),f,h)}else{d=a.getSingleElementByTagNameNS(b,f,e[c]);if(!d)d=a.newDomElement(b,e[c],f,h)}b=d}if(b.nodeType===2)b.value=g;else if(j){b.setAttribute("type","xhtml");a.appendAsXml(b,g)}else a.appendPreserving(b,g)},oc=function(d){if(d.childNodes.length)return false;var c=d.attributes,e=c.length;if(e===0)return true;for(var a=0;a<e;a++){var b=c[a].nodeName;if(b!=="xmlns"&&b.indexOf("xmlns:")!==0)return false}return true},gc=function(k,o){var c=a.getSingleElementByTagNameNS(k.domNode,g,"properties");if(!c){var j=a.getSingleElementByTagNameNS(k.domNode,f,"content");if(j)c=a.getSingleElementByTagNameNS(j,g,"properties")}if(c){var b=c,h=o.split("/"),e,m;for(e=0,m=h.length-1;e<m;e++){b=a.getSingleElementByTagNameNS(b,n,h[e]);if(!b)return}var i=a.getSingleElementByTagNameNS(b,n,h[e]);i&&b.removeChild(i);var d=b;while(d!==c&&oc(d)){var l=d.parentNode;l.removeChild(d);d=l}}},T=function(a,g,e,n,k,c,o){var h=a["FC_TargetPath"+c],i=Z(h),m=h!==i?f:a["FC_NsUri"+c],j=a["FC_KeepInContent"+c]==="true"?true:false,l=a["FC_ContentKind"+c]==="xhtml",p=a["FC_NsPrefix"+c]||null,d=eb(g,n);if(d===null||d===b)return;if(!j){Qb(o,"2.0");gc(e,g)}d=W(d,k);lc(m,p,i,e.domNode,l,d)},S=function(a,h,k,g,e,c){if(a["FC_KeepInContent"+c]==="true")return;if(eb(h,g)===null)return;var i=a["FC_TargetPath"+c],j=Z(i),l=i!==j?f:a["FC_NsUri"+c],m=a["FC_ContentKind"+c]==="xhtml",d=kc(l,j,k.domNode,m);if(d===b)return;d=U(d,e);Yb(h,g,d,e)},I=function(h,c,l){var j=l.split("/"),e,k;while(c){var f=c;for(e=0,k=j.length;e<k;e++){var d=f.property;if(!d)break;var a,g,i=false;for(a=0,g=d.length;a<g;a++)if(d[a].name===j[e]){i=true;break}if(!i)break;var b=d[a].type;if(!b||L(b))return b||null;f=dc(b,h);if(!f)return null}c=x(c.baseType,h)}return null},Pb=function(l,h,d){if(!d||d.length===0)return;var j=h.__metadata.type;while(j){var a=x(j,d);if(!a)return;var c,b=a.FC_SourcePath;if(b){c=I(d,a,b);S(a,b,l,h,c,"")}var i=a.property;if(i){var g,n;for(g=0,n=i.length;g<n;g++){var e=i[g],k=0,f="";while(e["FC_TargetPath"+f]){b=e.name;c=e.type;var m=e["FC_SourcePath"+f];if(m){b+="/"+m;c=I(d,a,b)}S(e,b,l,h,c,f);k++;f="_"+k}}}j=a.baseType}},rb=function(c,d){var b={__metadata:{}},e=a.attribute(c,"etag",g);if(e)b.__metadata.etag=e;a.childElements(c,function(c){if(c.nsURI===f)switch(c.localName){case"id":b.__metadata.uri=k(a.innerText(c.domNode),c.baseURI);b.__metadata.uri_extensions=o(c);break;case"category":fc(c,b);case"content":Xb(c,b);break;case"link":ec(c,b,d)}c.nsURI===g&&c.localName==="properties"&&G(c,b,b.__metadata)});Pb(c,b,d);return b},fc=function(d,b){var e=a.attribute(d,"scheme"),f=a.attribute(d,"term");if(e===wb){if(b.__metadata.type)throw{message:"Invalid AtomPub document: multiple category elements defining the entry type were encounterd withing an entry",element:d};b.__metadata.type=f;b.__metadata.type_extensions=[];var c;a.attributes(d,function(a){if(!a.nsURI){if(a.localName!=="scheme"&&a.localName!=="term"){c=p(a);b.__metadata.type_extensions.push(c)}}else if(y(a.nsURI)){c=p(a);b.__metadata.type_extensions.push(c)}})}},Xb=function(b,c){var d=a.attribute(b,"src"),e=a.attribute(b,"type");if(d){if(!e)throw{message:"Invalid AtomPub document: content element must specify the type attribute if the src attribute is also specified",element:b};c.__metadata.media_src=k(d,b.baseURI);c.__metadata.content_type=e}a.childElements(b,function(a){if(d)throw{message:"Invalid AtomPub document: content element must not have child elements if the src attribute is specified",element:b};a.nsURI===g&&a.localName==="properties"&&G(a,c,c.__metadata)})},Jb=function(b,c){c.__metadata.edit_media=b.href;c.__metadata.edit_media_extensions=[];var a,d;for(a=0,d=b.extensions.length;a<d;a++)if(b.extensions[a].namespaceURI===g&&b.extensions[a].name==="etag")c.__metadata.media_etag=b.extensions[a].value;else c.__metadata.edit_media_extensions.push(b.extensions[a])},ec=function(c,b,d){var a=ub(c);switch(a.rel){case"self":b.__metadata.self=a.href;b.__metadata.self_link_extensions=a.extensions;break;case"edit":b.__metadata.edit=a.href;b.__metadata.edit_link_extensions=a.extensions;break;case"edit-media":Jb(a,b);break;default:a.rel.indexOf(K)===0&&Ib(c,a,b,d)}},Ib=function(h,e,d,i){var f=e.rel.substring(K.length),c=b;a.childElements(h,function(b){if(b.nsURI===g&&b.localName==="inline"){var d=a.firstElement(b);if(d)c=hb(d,i);else c=null}});if(c===b)c={__deferred:{uri:e.href}};d[f]=c;d.__metadata.properties=d.__metadata.properties||{};d.__metadata.properties[f]={extensions:e.extensions}},G=function(c,d,b){a.childElements(c,function(a){if(a.nsURI===n){b.properties=b.properties||{};Ub(a,d,b.properties)}})},Ub=function(c,j,i){var f=null,d="Edm.String",e=[];a.attributes(c,function(a){if(a.nsURI===g)switch(a.localName){case"null":f=a.domNode.nodeValue;return;case"type":d=a.domNode.nodeValue;return}if(y(a.nsURI)){var b=p(a);e.push(b)}});var b=null,h={type:d,extensions:e};if(f!=="true"){b=a.innerText(c.domNode);if(L(d))b=U(b,d);else if(a.firstElement(c)){b={__metadata:{type:d}};G(c,b,h)}}j[c.localName]=b;i[c.localName]=h},Mb=function(c){var b={workspaces:[],extensions:[]};a.childElements(c,function(a){if(a.nsURI===u&&a.localName==="workspace"){var e=Fb(a);b.workspaces.push(e)}else{var d=q(c);b.extensions.push(d)}});if(b.workspaces.length===0)throw{message:"Invalid AtomPub service document: No workspace element found.",element:c};return b},Fb=function(c){var b={collections:[],extensions:[]};a.childElements(c,function(d){if(d.nsURI===f){if(d.localName==="title"){if(c.title)throw{message:"Invalid AtomPub service document: workspace has more than one child title element",element:d};b.title=a.innerText(d.domNode)}}else if(d.nsURI===u){if(d.localName==="collection"){var e=Eb(d,b);b.collections.push(e)}}else{var g=q(c);b.extensions.push(g)}});b.title=b.title||"";return b},Eb=function(c){var b={href:a.attribute(c,"href"),extensions:[]};if(!b.href)throw{message:"Invalid AtomPub service document: collection has no href attribute",element:c};b.href=k(b.href,c.baseURI);a.childElements(c,function(d){if(d.nsURI===f){if(d.localName==="title"){if(b.title)throw{message:"Invalid AtomPub service document: collection has more than one child title element",element:d};b.title=a.innerText(d.domNode)}}else if(d.nsURI!==u){var e=q(c);b.extensions.push(e)}});if(!b.title)throw{message:"Invalid AtomPub service document: collection has no title element",element:c};return b},hc=function(b,c){var a,e=s(b);switch(e){case d.feed:a=sb(null,b,c);break;case d.entry:case d.complexType:a=M(null,b,c);break;default:throw{message:'Serialization of payloads of type "'+e+'" is not supported'};}return a},tb=function(c,d){if(c)return a.newElement(c,d,f);var b=a.newDocument(d,f);a.addNamespaceAttribute(b.domNode,"xmlns:d",n);a.addNamespaceAttribute(b.domNode,"xmlns:m",g);return b},sb=function(g,c,f){var d=tb(g,"feed"),b=l(c)?c:c.results;if(b){var a,e;for(a=0,e=b.length;a<e;a++)M(d,b[a],f)}return d},M=function(k,c,e){var b=tb(k,"entry"),j=a.newElement(b,"author",f);a.newElement(j,"name",f);a.newElement(b,"title",f);var d=a.newElement(b,"content",f);a.newAttribute(d,"type",null,"application/xml");var i=a.newElement(d,vc,g),h=c.__metadata?c.__metadata.properties:null;Ob(b,c.__metadata);X(b,i,c,h,e);Vb(b,c,e);return b},Vb=function(l,e,i){if(!e.__metadata)return;var h=i.metadata,a=x(e.__metadata.type,h);while(a){var k,c=a.FC_SourcePath;if(c){k=I(h,a,c);T(a,c,l,e,k,"",i)}var g=a.property;if(g){var f,m;for(f=0,m=g.length;f<m;f++){var b=g[f],j=0,d="";while(b["FC_TargetPath"+d]){c=b.name;if(b["FC_SourcePath"+d])c+="/"+b["FC_SourcePath"+d];T(b,c,l,e,b.type,d,i);j++;d="_"+j}}}a=x(a.baseType,h)}},Ob=function(c,b){if(b){b.etag&&a.newAttribute(c,"etag",g,b.etag);b.uri&&a.newElement(c,"id",f,b.uri);if(b.type){var d=a.newElement(c,"category",f);a.newAttribute(d,"term",null,b.type);a.newAttribute(d,"scheme",null,wb)}}},cc=function(c,d,e){var b=a.newElement(c,"link",f);a.newAttribute(b,"rel",null,e);a.newAttribute(b,"href",null,d);return b},X=function(j,g,h,f,e){var a,c,d,b;for(a in h)if(a!=="__metadata"){c=h[a];d=rc(c);switch(d){case i.primitive:case i.complex:b=f?f[a]:null;cb(g,a,d,c,b,e);break;case i.deferred:case i.inline:Hb(j,d,a,c,e);break;case i.none:!(b&&b[a]&&!L(b[a]))&&cb(g,a,i.primitive,c,null,e)}}},cb=function(j,m,l,e,c,k){var h=a.qualifyXmlTagName(m,"d"),d=c&&c.type,b;if(l===i.complex){b=a.newElement(j,h,n);var f;if(c)f=c.properties;X(null,b,e,f,k)}else b=a.newElement(j,h,n,W(e,d||"Edm.String"));e===null&&a.newAttribute(b,Sb,g,"true");d&&a.newAttribute(b,Tb,g,d)},Hb=function(m,n,o,b,l){var f,c,e;if(n===i.inline){f=b.__metadata?b.__metadata.uri:"";e=s(b);switch(e){case d.entry:c=M;break;case d.feed:c=sb;break;default:throw{message:"Invalid payload for inline navigation property: "+e};}}else f=b.__deferred.uri;var p=k(o,K),h=cc(m,f,p);if(c){var j=a.newElement(h,Ic,g);a.newAttribute(h,"type",null,"application/atom+xml;type="+e);c(j,b,l)}},Ec=function(e,c,d){if(c){var b=a.parse(c);if(b)return hb(b,d.metadata)}},mc=function(h,g,c){var e=c.contentType=c.contentType||t(qb),d=b;if(e&&e.mediaType===qb){var f=hc(g,c);d=a.serialize(f)}return d};c.atomHandler=B(Ec,mc,ib.join(","),"2.0");var j={elements:{Association:{attributes:["Name"],elements:["End*","ReferentialConstraint"]},AssociationSet:{attributes:["Name","Association"],elements:["End*"]},CollectionType:{attributes:["ElementType","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation"]},ComplexType:{attributes:["Name","BaseType","Abstract"],elements:["Property*"]},DefiningExpression:{text:true},Dependent:{attributes:["Role"],elements:["PropertyRef*"]},Documentation:{text:true},End:{attributes:["Type","Role","Multiplicity","EntitySet"],elements:["OnDelete"]},EntityContainer:{attributes:["Name","Extends"],elements:["EntitySet*","AssociationSet*","FunctionImport*"]},EntitySet:{attributes:["Name","EntityType"]},EntityType:{attributes:["Name","BaseType","Abstract","OpenType"],elements:["Key","Property*","NavigationProperty*"]},Function:{attributes:["Name","ReturnType"],elements:["Parameter*","DefiningExpression","ReturnType"]},FunctionImport:{attributes:["Name","ReturnType","EntitySet"],elements:["Parameter*"]},Key:{elements:["PropertyRef*"]},NavigationProperty:{attributes:["Name","Relationship","ToRole","FromRole"]},OnDelete:{attributes:["Action"]},Parameter:{attributes:["Name","Type","Mode","MaxLength","Precision","Scale"]},Principal:{attributes:["Role"],elements:["PropertyRef*"]},Property:{attributes:["Name","Type","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","ConcurrencyMode"]},PropertyRef:{attributes:["Name"]},ReferenceType:{attributes:["Type"]},ReferentialConstraint:{elements:["Principal","Dependent"]},ReturnType:{attributes:["ReturnType"],elements:["CollectionType","ReferenceType","RowType"]},RowType:{elements:["Property*"]},Schema:{attributes:["Namespace","Alias"],elements:["Using*","EntityContainer*","EntityType*","Association*","ComplexType*","Function*"]},TypeRef:{attributes:["Type","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation"]},Using:{attributes:["Namespace","Alias"]}}},Y=["m:FC_ContentKind","m:FC_KeepInContent","m:FC_NsPrefix","m:FC_NsUri","m:FC_SourcePath","m:FC_TargetPath"];j.elements.Property.attributes=j.elements.Property.attributes.concat(Y);j.elements.EntityType.attributes=j.elements.EntityType.attributes.concat(Y);j.elements.Edmx={attributes:["Version"],elements:["DataServices"],ns:Cb};j.elements.DataServices={elements:["Schema*"],ns:Cb};j.elements.EntityContainer.attributes.push("m:IsDefaultEntityContainer");j.elements.Property.attributes.push("m:MimeType");j.elements.FunctionImport.attributes.push("m:HttpMethod");j.elements.EntityType.attributes.push("m:HasStream");j.elements.DataServices.attributes=["m:DataServiceVersion"];var O=function(a){if(!a)return a;if(a.length>1){var b=a.substr(0,2);return b===b.toUpperCase()?a:a.charAt(0).toLowerCase()+a.substr(1)}return a.charAt(0).toLowerCase()},nc=function(g,e){if(e==="Documentation")return{isArray:true,propertyName:"documentation"};var c=g.elements;if(!c)return null;var b,f;for(b=0,f=c.length;b<f;b++){var a=c[b],d=false;if(a.charAt(a.length-1)==="*"){d=true;a=a.substr(0,a.length-1)}if(e===a){var h=O(a);return{isArray:d,propertyName:h}}}return null},H=function(b){if(!b.domNode)b=a._wrapNode(b,"");var p=b.localName,d=j.elements[p];if(!d)return null;if(d.ns){if(b.nsURI!==d.ns)return null}else if(b.nsURI!==Pc&&b.nsURI!==Mc&&b.nsURI!==Nc)return null;var c={},k=d.attributes;if(k){var h,o;for(h=0,o=k.length;h<o;h++){var e=k[h],n=e.indexOf(":"),i="";if(n>0){i=g;e=e.substr(n+1)}var f=a.attribute(b,e,i);if(f){c[O(e)]=f;var m=1;while(1){var l=e+"_"+m;f=a.attribute(b,l,i);if(!f)break;c[O(l)]=f;m++}}}}a.childElements(b,function(e){var a=nc(d,e.localName);if(a)if(a.isArray){var b=c[a.propertyName];if(!b){b=[];c[a.propertyName]=b}b.push(H(e))}else c[a.propertyName]=H(e)});if(d.text)c.text=a.innerText(b);return c},qc=function(e,c){var d=a.parse(c);return H(d)||b};c.metadataHandler=B(qc,null,Ac,"1.0");var N="application/json",Kb=function(d,g){var b={collections:[]},a,e;for(a=0,e=d.EntitySets.length;a<e;a++){var c=d.EntitySets[a],f={title:c,href:k(c,g)};b.collections.push(f)}return{workspaces:[b]}},Gc=function(c,d,b){var a=e.JSON.parse(d).d;a=c._updateDataFromVersion(a,b.dataServiceVersion);a=c._normalizeData(a,b.response.requestUri);return a},pc=function(i,g,a){var d=b,f=a.contentType=a.contentType||t(N);if(f&&f.mediaType===N){var c=a.dataServiceVersion,h=g;if(c&&c!=="1.0")h={results:[g]};d=e.JSON.stringify(h)}return d};c.jsonHandler=B(Gc,pc,N,"2.0");c.jsonHandler._normalizeData=function(a,b){return s(a)===d.svcDoc?Kb(a,b):a};c.jsonHandler._updateDataFromVersion=function(b,a){if(a&&a.lastIndexOf(";")===a.length-1)a=a.substr(0,a.length-1);if(!a)if(l(b))a="1.0";if(a==="2.0")return b;if(a==="1.0")if(l(b))b={results:b};return b};var Bb=[c.jsonHandler,c.atomHandler],kb=function(d,c,e){var a,b;for(a=0,b=Bb.length;a<b&&!Bb[a][d](c,e);a++);if(a===b)throw{message:"no handler for data"};};c.defaultSuccess=function(a){e.alert(a.toString())};c.defaultError=function(a){throw a;};c.defaultHandler={read:function(a,c){a&&a.body!==null&&a.body!==b&&a.headers["Content-Type"]&&kb("read",a,c)},write:function(b,a){kb("write",b,a)},accept:"application/atomsvc+xml;q=0.8, application/json;q=0.5, */*;q=0.1"};c.defaultMetadata=[];var r="multipart/mixed",bc=new RegExp("^HTTP/1\\.\\d (\\d{3}) (.*)$","i"),P=function(){return Math.floor((1+Math.random())*65536).toString(16).substr(1)},lb=function(a){return a+P()+"-"+P()+"-"+P()},xb=function(a){return a.handler.partHandler},jb=function(b){var a=b.boundaries;return a[a.length-1]},Bc=function(d,c,a){var b=a.contentType.properties.boundary;return{__batchResponses:Ab(c,{boundaries:[b],handlerContext:a})}},jc=function(d,c,a){var b=a.contentType=a.contentType||t(r);if(b.mediaType===r)return Hc(c,a)},Ab=function(b,a){var f="--"+jb(a);D(b,a,f);A(b,a);var e=[],g;while(g!=="--"&&a.position<b.length){var h=yb(b,a),d=t(h["Content-Type"]);if(d&&d.mediaType===r){a.boundaries.push(d.properties.boundary);e.push({__changeResponses:Ab(b,a)});a.boundaries.pop();D(b,a,"--"+jb(a))}else{if(!d||d.mediaType!=="application/http")throw{message:"invalid MIME part type "};var c=yc(b,a,f);try{if(c.statusCode>=200&&c.statusCode<=299)xb(a.handlerContext).read(c,a.handlerContext);else c={message:"HTTP request failed",response:c}}catch(i){c=i}e.push(c)}g=b.substr(a.position,2);A(b,a)}return e},yb=function(e,d){var c={},a,b;while(b=A(e,d)){a=b.indexOf(":");if(a!==-1)c[z(b.substring(0,a))]=z(b.substring(a+1))}return c},yc=function(c,a,d){var b=bc.exec(A(c,a));if(!b)throw{message:"Invalid HTTP response"};return{statusCode:b[1],statusText:b[2],headers:yb(c,a),body:D(c,a,d)}},A=function(b,a){return D(b,a,"\r\n")},D=function(c,b,d){var e=b.position||0,a=c.length;if(d){a=c.indexOf(d,e);if(a===-1)return null;b.position=a+d.length}else b.position=a;return c.substring(e,a)},Hc=function(g,f){var h=s(g);if(h!==d.batch)throw{message:'Serialization of batches of type "'+h+'" is not supported'};var b=lb("batch_"),e=g.__batchRequests,c="",a,i;for(a=0,i=e.length;a<i;a++)c+=w(b,false)+pb(e[a],f);c+=w(b,true);var j=f.contentType.properties;j.boundary=b;return c},w=function(b,c){var a="\r\n--"+b;if(c)a+="--";return a+"\r\n"},pb=function(f,e,h){var d=f.__changeRequests,a;if(l(d)){if(h)throw{message:"Not Supported: change set nested in other change set"};var c=lb("changeset_");a="Content-Type: "+r+"; boundary="+c+"\r\n";var b,g;for(b=0,g=d.length;b<g;b++)a+=w(c,false)+pb(d[b],e,true);a+=w(c,true)}else{a="Content-Type: application/http\r\nContent-Transfer-Encoding: binary\r\n\r\n";ob(f,xb(e),{metadata:e.metadata});a+=zc(f)}return a},zc=function(a){var b=(a.method?a.method:"GET")+" "+a.requestUri+" HTTP/1.1\r\n";for(var c in a.headers)if(a.headers[c])b=b+c+": "+a.headers[c]+"\r\n";b+="\r\n";if(a.body)b+=a.body;return b};c.batchHandler=B(Bc,jc,r,"1.0");c.batchHandler.partHandler=c.defaultHandler;c.read=function(a,g,h,f,d,e){var b;if(a instanceof String||typeof a==="string")b={requestUri:a};else b=a;c.request(b,g,h,f,d,e)};c.request=function(h,f,b,a,d,e){if(!f)f=c.defaultSuccess;if(!b)b=c.defaultError;if(!a)a=c.defaultHandler;if(!d)d=c.defaultHttpClient;if(!e)e=c.defaultMetadata;var g={metadata:e};try{ob(h,a,g);tc(h,f,b,a,d,g)}catch(i){b(i);return}}})(this)