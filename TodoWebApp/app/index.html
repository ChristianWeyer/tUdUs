<!DOCTYPE html>
<html>
<head>
	<title>tUdUs</title>

	<meta charset="utf-8">
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0" />
	
	<link rel="apple-touch-icon" href="images/Wooden_Todo_128x128.png" />
	<link rel="apple-touch-startup-image" href="images/splash.png" media="screen and (max-device-width: 320px)" />
	
	<link href="styles/kendo.mobile.all.min.css" rel="stylesheet" type="text/css" />
	<link href="styles/app.min.css" rel="stylesheet" type="text/css" />
    <link href="styles/jquery_notification.css" rel="stylesheet" type="text/css" />

	<script src="js/libs/jquery-1.7.1.min.js" type="text/javascript"></script>
    <script src="js/libs/jquery-ajax-retry.js" type="text/javascript"></script>

	<script src="cordova.js" type="text/javascript"></script>
    <script src="childbrowser.js" type="text/javascript"></script>

    <script src="js/libs/jquery-ui-1.8.20.min.js" type="text/javascript"></script>
    <script src="js/libs/underscore-min.js" type="text/javascript"></script>
	<script src="js/libs/jquery.base64.min.js" type="text/javascript"></script>
	<script src="js/libs/kendo.mobile.min.js" type="text/javascript"></script>
	<script src="js/libs/amplify.min.js" type="text/javascript"></script>
	<script src="js/libs/notifier.min.js" type="text/javascript"></script>
	<script src="js/libs/jquery.signalR-0.5.3.min.js" type="text/javascript"></script>
    <script src="js/libs/jquery.ba-bbq.min.js" type="text/javascript"></script>
	<script src="js/libs/signalr.hubs.min.js" type="text/javascript"></script>
	<script src="js/libs/jquery_notification_v.1.js" type="text/javascript"></script>
	
    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyCG4jUolof0jhqQu0j1aNqSWfW_ms-wRKg&sensor=true"></script>
	
	<script src="js/namespaces.js" type="text/javascript"></script>
    <script src="js/helpers.js" type="text/javascript"></script>
    <script src="js/templateLoader.js" type="text/javascript"></script>
	<script src="js/app.js" type="text/javascript"></script>
    <script src="js/applicationConstants.js" type="text/javascript"></script>
	<script src="js/views.js" type="text/javascript"></script>
    <script src="js/services/httpConstants.js" type="text/javascript"></script>    
    <script src="js/services/notificationservice.js" type="text/javascript"></script>
	<script src="js/services/dataservices.js" type="text/javascript"></script>
    <script src="js/services/pictureservice.js" type="text/javascript"></script>
    <script src="js/viewmodels/startViewModel.js" type="text/javascript"></script>
	<script src="js/viewmodels/authenticationViewModel.js" type="text/javascript"></script>
	<script src="js/viewmodels/todosViewModel.js" type="text/javascript"></script>
	<script src="js/viewmodels/newTodoItemViewModel.js" type="text/javascript"></script>
	<script src="js/viewmodels/errorViewModel.js" type="text/javascript"></script>
    <script src="js/viewmodels/acsViewModel.js" type="text/javascript"></script>
    <script src="js/viewmodels/settingsViewModel.js" type="text/javascript"></script>
</head>
<body>
    <!-- Templates -->    
    <script id="tasksListTemplate" type="text/x-kendo-template">
        # if (typeof isAdded !== 'undefined') { #
            # if (isAdded) { #
                <a class="details-link" style="color: darkred; font-style: italic;" data-role="listview-link" href="\#todoDetailsPage?id=#:id#">#= title#</a>
            # } #
        # } else { #
            <a class="details-link" data-role="listview-link" href="\#todoDetailsPage?id=#:id#">#= title#</a>
        # } #
        
	    <a data-role="detailbutton" data-style="rowdelete" data-bind="events:{click: removeTodo}"></a>
    </script>

    <script id="idpListTemplate" type="text/x-kendo-template">
        <img src="${imageUrl}" style="border: 50px; width: 60px" align="middle"/>
        <a onclick="acsViewModel.openAuthWindow('${loginUrl}')">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${name}</a>
	</script>

    <!-- Start page -->
	<div id="startPage" data-role="view" data-title="tUdUs" data-model="startViewModel" data-layout="defaultLayout">
		<header data-role="header">
			<div data-role="navbar">
				<span data-role="view-title"></span>
			</div>
		</header>
        <img src="images/Wooden_Todo_256x256.png" alt="tUdUs" />
		<a data-role="button" id="openLoginButton" data-bind="click: openLoginView">Login</a>
	</div>

    <!-- ACS Login page -->
    <div id="acsLogin" data-role="view" data-title="Login" data-model="acsViewModel" data-show="todosApp.Views.acsLoginShow" data-layout="defaultLayout">
		<header data-role="header">
			<div data-role="navbar">
				<span data-role="view-title"></span>
			</div>
		</header>		
		<br />
		<h2>Choose your Identity Provider</h2>
		<br />

        <ul id="idps" data-role="listview" data-bind="source: idpsSource" data-template="idpListTemplate" data-style="inset">
		</ul>
	</div>

	<!-- tUdUs page -->
    <div id="todosPage" data-role="view" data-title="tUdUs" data-model="todosViewModel" data-init="todosApp.Views.todosPageInit" data-before-show="todosApp.Views.beforePageShow" data-layout="defaultLayout">
	    <header data-role="header">
		    <div data-role="navbar">
			    <span data-role="view-title"></span>
			    <a data-align="right" data-role="button" class="nav-button" data-icon="add" data-bind="click: navigateAddTodo"></a>
			    <a data-align="left" data-role="button" class="nav-button" data-icon="refresh" data-bind="click: loadTodos"></a>
                <a data-align="left" data-role="button" class="nav-button" data-icon="fastforward" data-click="dataservices.sync"></a>
		    </div>
	    </header>
		
	    <br />
	    <h2>Items</h2>
				
	    <ul id="tasksList" data-role="listview" data-style="inset" data-bind="source: todosSource" data-template="tasksListTemplate" >
	    </ul>
    </div>

	<!-- tUdU details page -->
	<div id="todoDetailsPage" data-role="view" data-title="Details" data-model="todosViewModel" data-show="todosViewModel.navigateTodoDetails" data-before-show="todosApp.Views.beforePageShow" data-layout="defaultLayout">
		<header data-role="header">
			<div data-role="navbar">
				<a data-role="backbutton" data-align="left">Back</a>
				<span data-role="view-title"></span>
			</div>
		</header>
        <br />
		<h2>Item Details</h2>

		<ul data-role="listview" data-style="inset">
			<li>
				<label for="tasktitle">Title:</label>
				<input type="text" id="tasktitle" data-bind="value: currentItem.title" />
			</li>
			<li>
				<label for="details">Details:</label>
				<input type="text" id="details" data-bind="value: currentItem.details" />
			</li>
		    <li>
		        <label for="done">Done:</label>
		        <input id="done" data-role="switch" data-bind="checked: currentItem.done" />
		    </li>
            <li>
				<label for="created">Created:</label>
				<input type="text" id="created" data-bind="value: currentItem.created" />
			</li>
            <li data-bind="visible: pictureAvailable">
                <img src="" style="margin: 0px auto; display: block; width: 200px" data-bind="attr: { src: currentItem.pictureUrl }" />
            </li>
		</ul>

		<br />
	    <a id="saveTodoButton" data-bind="click: updateTodo" data-role="button">Save</a>
        <br/>
	</div>
	
    <!-- Add tUdU page -->
    <div id="addTodoPage" data-role="view" data-title="tUdUs" data-transition="overlay:up" data-model="newTodoItemViewModel" data-init="todosApp.Views.addTodoPageInit" data-show="todosApp.Views.addTodoPageShow" data-before-show="todosApp.Views.beforePageShow" data-layout="defaultLayout">
        <header data-role="header">
            <div data-role="navbar">
                <a data-role="backbutton" data-align="left">Back</a>
                <span data-role="view-title"></span>
            </div>
        </header>
        <br />
        <h2>New Item</h2>
		
        <ul data-role="listview" data-style="inset">
            <li>
                <label for="newtasktitle">Title:</label>
                <input data-bind="value: title" type="text" name="Title" id="newtasktitle" required />
            </li>
            <li>
                <label for="newtaskdetails">Details:</label>
                <input data-bind="value: details" type="text" id="newtaskdetails" />
            </li>            
        </ul>
        
        <ul data-role="listview" data-style="inset">
            <li id="map">
                <div id="mapCanvas" style="width:100%;"></div>
            </li>
        </ul>

        <a data-role="button" style="margin: 0 0 0 1.1em;" data-icon="camera" data-bind="click: takePicture">Take picture</a>            
        <ul data-role="listview" data-style="inset">
            <li id="capturedImagePane" style="display: none">
                <img src="" style="margin: 0px auto; display: block; width: 220px" id="capturedImage" data-bind="attr: { src: pictureUrl }"/>
            </li>
        </ul>

        <br />
        <a id="addTodoButton" data-bind="click: saveTodo" data-role="button">Save</a>
        <br /><br />
    </div>    

    <!-- Settings page -->
	<div id="settingsPage" data-role="view" data-title="tUdUs" data-model="settingsViewModel" data-layout="defaultLayout">
		<header data-role="header">
			<div data-role="navbar">
				<span data-role="view-title"></span>
			</div>
		</header>
		<br />
		<h2>Settings</h2>
			
	    <ul data-role="listview" data-style="inset">
	        <li>
	            <select data-bind="value: authenticationMode">
	                <option value="Basic">Basic</option>
	                <option value="ACS">ACS</option>
	            </select>
	            Authentication
	        </li>
	    </ul>
	</div>

	<!-- Info/About page -->
	<div id="infoPage" data-role="view" data-title="tUdUs" data-layout="defaultLayout">
		<header data-role="header">
			<div data-role="navbar">
				<span data-role="view-title"></span>
			</div>
		</header>
		<br />
		<h2>About tUdUs</h2>
			
		<ul data-role="listview" data-style="inset">
			<li>
				Version 0.4 (2012-10-15.1)
				<img data-align="right" alt="tUdUs" src="images/Wooden_Todo_32x32.png" style="float: right"/>
			</li>
			<li>
				<a href="mailto:christian.weyer@thinktecture.com?Subject=Question about tUdUs app (2012-10-15.1)" data-rel="external">Christian Weyer</a>
				<a data-role="detailbutton" data-icon="compose"></a>
			</li>
		</ul>      				
	</div>
	
    <!-- Layouts -->
    <div data-role="layout" data-id="defaultLayout">
        <footer data-role="footer">
			<div data-role="tabstrip">
				<a data-icon="home" href="#startPage">Home</a>
				<a data-icon="bookmarks" href="#todosPage">Items</a>
                <a data-icon="settings" href="#settingsPage">Settings</a>
				<a data-icon="info" href="#infoPage">Info</a>
			</div>
		</footer>
    </div>

    <!-- Global modal views/dialogs -->
	<!-- Login dialog -->
	<div data-role="modalview" id="loginDialog" style="width: 95%; height: 50%;" data-model="authenticationViewModel">
		<div data-role="header">
			<div data-role="navbar">
				<span data-role="view-title">User Login</span>
				<a data-bind="click: closeLoginDialog" data-role="button" data-align="right">Cancel</a>
			</div>
		</div>
		<ul data-role="listview" data-style="inset">
			<li>
				<label for="username">Username:</label>
				<input data-bind="value: userName" type="text" id="username" /></li>
			<li>
				<label for="password">Password:</label>
				<input data-bind="value: password" type="password" id="password" /></li>
		</ul>
		<a data-bind="click: doLogin" id="loginButton" data-role="button" data-align="right">Login</a>
	</div>

	<!-- Error dialog -->
    <div data-role="modalview" id="errorDialog" style="width: 85%; height: 40%;" data-model="errorViewModel">
        <div data-role="header">
            <div data-role="navbar">
                <span data-role="view-title">Error</span>
                <a data-bind="click: closeErrorDialog" data-role="button" data-align="right">X</a>
            </div>
        </div>
        <ul data-role="listview" id="errorText">
            <li><span data-bind="text: message">Error.</span></li>
        </ul>
        <p>
            <a data-role="button" type="button" id="commonErrorButton" data-bind="click: closeErrorDialog">OK</a>
        </p>
    </div>        
</body>
</html>
